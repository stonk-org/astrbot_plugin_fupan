# astrbot_plugin_fupan

AstrBot 复盘插件，用于帮助交易者进行每日复盘。支持交易日判断、时间窗口控制、数据统计等功能。

## 📖 介绍

AstrBot 复盘插件，用于帮助交易者进行每日复盘。支持交易日判断、时间窗口控制、数据统计等功能。

数据存储在 AstrBot 的 `data/astrbot_plugin_fupan/` 目录下，遵循 AstrBot 插件开发规范。

## ⚙️ 配置

在 AstrBot 的 WebUI 中配置插件参数：

- `fupan_checkin_start_time`: 复盘开始时间（交易日当天），默认值：15:00
- `fupan_checkin_end_time`: 复盘结束时间（下一交易日），默认值：09:00
- `fupan_checkin_group_time_windows`: 群组特定时间窗口配置，默认值：{}
- `fupan_checkin_user_time_windows`: 用户特定时间窗口配置，默认值：{}

### 高级配置示例

#### 群组特定时间窗口配置
```json
{
  "123456": {
    "start_time": "16:00",
    "end_time": "08:00"
  }
}
```

#### 用户特定时间窗口配置
```json
{
  "user123": {
    "start_time": "17:00",
    "end_time": "07:00"
  }
}
```

## 🎉 使用

### 指令表

| 指令  | 权限  | 范围  |   说明   |
| :---: | :---: | :---: | :------: |
| 复盘 | 群员  | 群聊/私聊  | 进行复盘 |
| 复盘统计 | 群员  | 群聊/私聊  | 查看个人复盘统计 |
| 复盘排行 | 群员  | 群聊/私聊  | 查看复盘排行榜 |
| 复盘撤销/撤销复盘 | 群员  | 群聊/私聊  | 撤销最后一次复盘 |
| 复盘帮助 | 群员  | 群聊/私聊  | 查看帮助信息 |
| 复盘重置 | 管理员  | 群聊/私聊  | 重置数据（私聊/群组） |

### 使用说明

1. 用户可以在交易日的盘后时间窗口内进行复盘（默认15:00至下一个交易日的09:00）
2. 非交易日（周末、节假日）会自动调整复盘时间窗口
3. 每个用户每次盘后只能复盘一次
4. 支持查看个人统计和群内排行榜（基于连续复盘次数）
5. 支持按群组或用户设置特定的时间窗口
6. 用户可以使用"复盘撤销"或"撤销复盘"命令撤销最后一次复盘记录
7. 群聊和私聊的数据完全分离，互不影响
8. 管理员可以使用"复盘重置"命令重置数据：
   - `/复盘重置 私聊` - 重置所有私聊用户数据
   - `/复盘重置 当前群组` - 重置当前群组数据
   - `/复盘重置 群组<群号>` - 重置指定群组数据
9. 用户可以使用"复盘帮助"命令查看所有可用指令
10. 详细的复盘日志记录功能，包括时间戳、星期分布、交易日信息等统计信息
11. 连续复盘计数功能，追踪用户的连续交易日复盘记录